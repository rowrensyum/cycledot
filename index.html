<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>recurring_decimal</title>
</head>
<body>
    <input type="number" id="son" placeholder="분자" min="1">
    <span>/</span>
    <input type="number" id="mom" placeholder="분모" min="1">
    <button id="submit" type="button">확인</button>

    <p id="result"></p>

    <script>
    document.getElementById('submit').addEventListener('click', function() {
        let son = parseInt(document.getElementById("son").value);
        let mom = parseInt(document.getElementById("mom").value);

        if (!son || !mom || mom === 0) {
            document.getElementById("result").innerText = "분모는 0이 될 수 없습니다!";
            return;
        }

        let a = []; // 몫 저장
        let seen = {}; // 나머지와 위치 저장

        let num = Math.floor(son / mom);
        let rem = son % mom;

        a.push(num);

        let repeatIndex = -1; // 반복 시작 위치 초기화
        while(rem !== 0) {
            if (seen[rem] !== undefined) { // 반복 시작 발견
                repeatIndex = seen[rem];
                break;
            }
            seen[rem] = a.length; // 현재 몫의 위치 저장
            son = rem * 10;
            num = Math.floor(son / mom);
            a.push(num);
            rem = son % mom;
        }

        // 단순 소수 (유한소수)
        if(rem === 0) {
            document.getElementById("result").innerHTML = "<b>" + a[0] + "." + a.slice(1).join('') + "</b>";
            return;
        }

        // 반복 소수 처리
        let num1 = a[0]; // 정수 부분
        let numbo = a.slice(1, repeatIndex).join(''); // 반복 시작 전 소수
        let repeat = a.slice(repeatIndex); // 반복 구간 전체

        // 반복 시작과 끝 모두 점 표시
        let repeatStart = repeat[0];
        let repeatRest = repeat.slice(1);
        let repeatEnd = repeatRest.pop() || "";

        document.getElementById("result").innerHTML =
            "<b>" + num1 + "." + numbo +
            "<ruby>" + repeatStart + "<rp>(</rp><rt>•</rt><rp>)</rp></ruby>" +
            repeatRest.join('') +
            "<ruby>" + repeatEnd + "<rp>(</rp><rt>•</rt><rp>)</rp></ruby></b>";
    });
    </script>
</body>
</html>
